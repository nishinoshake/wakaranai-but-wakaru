<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>わからないけどわかる</title>
<meta name="keywords" content="木村カエラ">
<style>
@font-face {
  font-family: "noto-serif";
  font-display: swap;
  src: url(/fonts/noto-serif-sub.woff2?d=20200322) format("woff2"), url(/fonts/noto-serif-sub.woff?d=20200322) format("woff");
}

:root {
  --color-font: #1a1a1a;
  --color-white: #fff;
  --border-width-sp: 2px;
  --border-width-pc: 3px;
}

*,
*:before,
*:after {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}
html,
body {
  width: 100%;
  height: 100%;
}
html {
  font-size: 10px;
}
body {
  display: flex;
  align-items: center;
  overflow: hidden;
  font-family: 'noto-serif', serif;
  color: var(--color-font);
  -webkit-font-smoothing: antialiased;
}
body:after {
  content: "";
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0;
  left: 0;
  background-color: var(--color-white);
  pointer-events: none;
}
body.is-grab {
  cursor: grab;
}
body.is-grabbing {
  cursor: grabbing;
}
body.is-grabbing .poem {
  pointer-events: none;
  user-select: none;
}
body.is-visible:after {
  transition: opacity 2s ease;
  opacity: 0;
}
body.is-playing .jacket__play:before {
  opacity: 0;
}
body.is-playing .jacket__play:after {
  opacity: 1;
}

.jacket {
  width: 100%;
  position: absolute;
  top: calc(50% - 12.6vh);
  right: 0;
  padding: 3vh;
  z-index: 1;
  display: flex;
  align-items: center;
  justify-content: flex-end;
  background: linear-gradient(to bottom, rgba(255, 255, 255, 0), white 20%, white 80%, rgba(255, 255, 255, 0));
}
.jacket__logo {
  width: 13vh;
  height: auto;
  fill: var(--color-font);
}
.jacket__play {
  width: 7.4vh;
  height: 7.4vh;
  position: relative;
  margin: 0 2vh 0 0;
  padding: 0;
  border: 0;
  border-radius: 50%;
  background: var(--color-font);
  outline: none;
  -webkit-appearance: none;
  cursor: pointer;
}
.jacket__play:before {
  content: "";
  width: 0;
  height: 0;
  position: absolute;
  top: 30%;
  left: 35%;
  border-style: solid;
  border-width: 0 1.8vh 3.2vh 1.8vh;
  border-color: transparent transparent var(--color-white) transparent;
  transform: rotate(90deg);
}
.jacket__play:after {
  content: "";
  width: 0.7vh;
  height: 3.2vh;
  opacity: 0;
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  margin: auto;
  border-left: 1vh solid var(--color-white);
  border-right: 1vh solid var(--color-white);
  box-sizing: content-box;
}

.poem {
  overflow: hidden;
}
.poem__inner {
  display: inline-block;
  transition: transform 3s cubic-bezier(0.33, 1, 0.68, 1);
}
.poem__list {
  display: inline-flex;
  white-space: nowrap;
  list-style-type: none;
  animation: kimura-kaela 59s 0s linear infinite;
  will-change: transform;
}
.poem__item {
  padding: 0 0.2em;
  font-size: calc(100vh / (6 * 3.4));
  letter-spacing: 0.18em;
  line-height: 2.3;
}
.poem__link,
.poem__link:hover,
.poem__link:visited {
  color: inherit;
  text-decoration: none;
}

@media screen and (min-width: 769px) {
  html {
    font-size: 16px;
  }
  .jacket {
    top: calc(50% - 14.8vh);
    padding: 3vh 7vh;
  }
  .poem__item {
    font-size: calc(100vh / (6 * 2.4));
    line-height: 2.2;
    letter-spacing: 0.25em;
  }
}

@keyframes kimura-kaela {
  0% {
    transform: translate3d(0, 0, 0);
  }
  100% {
    transform: translate3d(-50%, 0, 0);
  }
}
@keyframes kimura-rie {
  0%, 100% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.2);
  }
}
</style>
</head>
<body>
  <div class="jacket">
    <button type="button" class="jacket__play" aria-label="音楽を再生する"></button>
    <svg xmlns="http://www.w3.org/2000/svg" width="75" height="33" viewBox="0 0 75 33" class="jacket__logo">
      <path d="M14.3 2.7c0-.7-.1-1.4-.2-2.2h4.5c-.1.7-.2 1.4-.2 2.2V5h9.7c.7 0 1.4 0 2.1-.1v1.7c-.4 0-.5-.1-.7-.1h-7.6l4.4 1.7-.9 1c-1.3 1.7-2.7 3.4-4.2 5l-.2.2h9c.7 0 1.4 0 2.2-.1V16c-.4 0-.5-.1-.7-.1H2.8c-.6 0-1.2 0-1.8.1v-1.6c.7.1 1.4.1 2.2.1h5.9L9 13.3c-.3-1.7-.7-3.4-1.2-5.1l-.4-1 1.1-.6H4.7c-.6 0-1.2 0-1.8.1V4.9c.7.1 1.4.2 2.2.2h9.2V2.7zm13 15.7c-.1 1-.2 1.9-.2 2.9v8.1c0 1 0 2 .2 3h-.9c-.6-.1-1.2-.1-1.8-.1H5.9c.1-1 .2-1.9.2-2.9v-8.1c0-1 0-1.9-.2-2.9 1.1.1 1.9.1 2.7.1h15.9c.6 0 1.1 0 1.6-.1H27.3zM9.4 7.2c1.3 1.3 2.4 2.8 3.4 4.2l.9 1-4 1.9h9.4c.9-2.1 1.7-4.3 2.3-6.5l.2-1.4H8.8l.6.8zm.9 12.8v4.5h12.8V20H10.3zm0 5.9v5h12.8v-5H10.3zM50.4 11.9l-.8.7c-1.5 1.9-3.2 3.5-5.1 5l-.8.7-2.5-3.6 1.1-.3c2.2-.8 4.4-1.9 6.4-3.1l.7-.6 1 1.2zm11.5-7.4c.9 0 1.8 0 2.7-.1-.1 1-.2 1.9-.2 2.9v7.2c0 1 0 1.9.2 2.9-.7-.1-1.4-.1-2.1-.1h-2.9v3.3h11.6c.7 0 1.4 0 2.2-.1v1.7c-.7-.1-1.4-.2-2.2-.2H60.6c3.3 2.8 7.1 4.7 11.3 5.8l1.7.3-2.8 4.2-1.3-.8c-4-2-7.4-4.9-10.1-8.4v7.7c0 .7.1 1.4.2 2.2h-4.5v-.4c.1-.6.1-1.2.1-1.8v-6c-3.5 3.4-7.7 5.9-12.4 7.4l-1.2.5-.6-1.2 1.3-.5c4-2.2 7.5-5.2 10.1-9h-8.8c-.8 0-.8 0-1.9.2v-1.7c.7.1 1.4.1 2.2.1h11.3v-3.2H53c-.9 0-1.3 0-2.2.1.1-1 .2-1.9.2-2.9V7.3c0-1 0-1.9-.2-2.9.9.1 1.8.1 2.7.1H55c.4-1.1.6-2.2.8-3.3L56 .1l5 .9-1 .8c-.8.8-1.9 1.9-2.8 2.7h4.7zm-18-.9c1.7.8 3.4 1.7 5.1 2.6l.9.4-3.3 3.6-.5-1c-1-1.6-2.1-3.1-3.3-4.5L42 4l1-1 .9.6zm10.7 2.3V10h6.1V5.9h-6.1zm0 5.6v4.4h6.1v-4.4h-6.1zM73.9 6l-1 .5c-1.9 1.1-3.9 2.1-6 2.8l-.9.4-.9-1.2.8-.5c1.4-1.3 2.7-2.7 3.8-4.3l.5-.9L73.9 6zm-7.1 5.3c2 .8 4 1.8 5.9 2.8l1.1.4-3 3.7-.6-.9a48.1 48.1 0 00-4.2-4.8l-.8-.5.8-1.1.8.4z"/>
    </svg>
  </div>
  <div class="poem">
    <div class="poem__inner">
      <ul class="poem__list">
        <li class="poem__item">わからないけどわかる</li>
        <li class="poem__item">平凡な暮らし</li>
        <li class="poem__item">半乾きのタオル</li>
        <li class="poem__item">アウトローな同居人</li>
        <li class="poem__item">顔見知りの他人</li>
        <li class="poem__item">朝ドラが日課</li>
        <li class="poem__item">三日目の牡蠣</li>
        <li class="poem__item">覚えのある腹痛</li>
        <li class="poem__item">スマホで見る花火</li>
      </ul>
      <ul class="poem__list">
        <li class="poem__item">つり革を裏返す仕事</li>
        <li class="poem__item">なくならない無断欠勤</li>
        <li class="poem__item">反省の空気椅子</li>
        <li class="poem__item">喜びの現地解散</li>
        <li class="poem__item">募る将来への不安</li>
        <li class="poem__item">束の間の貯蓄</li>
        <li class="poem__item">年の瀬に散財</li>
        <li class="poem__item">納車日に骨折</li>
        <li class="poem__item">バランスのとれた食事</li>
      </ul>
      <ul class="poem__list">
        <li class="poem__item">雲泥の泥</li>
        <li class="poem__item">思いつきでリハビリ</li>
        <li class="poem__item">続かない習慣</li>
        <li class="poem__item">たたずむヨガマット</li>
        <li class="poem__item">迫り来る決戦の日</li>
        <li class="poem__item">二時間に渡る押し問答</li>
        <li class="poem__item">五分で終わる引き継ぎ</li>
        <li class="poem__item">あっけなく退職</li>
        <li class="poem__item">同居人の失踪</li>
      </ul>
      <ul class="poem__list">
        <li class="poem__item">自堕落な暮らし</li>
        <li class="poem__item">のりたまを箱買い</li>
        <li class="poem__item">期限切れのハチミツ</li>
        <li class="poem__item">伸びきったペヤング</li>
        <li class="poem__item">ピザポテトの抜け殻</li>
        <li class="poem__item">雑煮で乗り切った正月</li>
        <li class="poem__item">漬物で乗り切った二月</li>
        <li class="poem__item">再起を誓う三月</li>
      </ul>
      <ul class="poem__list">
        <li class="poem__item">周回遅れの学園生活</li>
        <li class="poem__item">人見知りが口癖</li>
        <li class="poem__item">馴染めない焦燥感</li>
        <li class="poem__item">学園祭アレルギー発覚</li>
        <li class="poem__item">バーベキュー拒否権行使</li>
        <li class="poem__item">狂い始める生活リズム</li>
        <li class="poem__item">見失う学問の意義</li>
        <li class="poem__item">退学を意味する留年</li>
      </ul>
      <ul class="poem__list">
        <li class="poem__item">有り余る時間</li>
        <li class="poem__item">ひとり映画館</li>
        <li class="poem__item">ひとりサイゼリヤ</li>
        <li class="poem__item">ひとりサファリパーク</li>
        <li class="poem__item">悟りきったライオン</li>
        <li class="poem__item">かわいいよガゼル</li>
        <li class="poem__item">馬の耳にモルダウ</li>
        <li class="poem__item">
          <a href="http://classical-sound.seesaa.net/article/312156442.html" target="_blank" rel="noopener" class="poem__link">クラシック名曲サウンドライブラリー</a>
        </li>
      </ul>
    </div>
  </div>
  <audio src="/audio/moldau.mp3?d=20200322" loop preload="none"></audio>
  <script>
    var body = document.body
    var audio = document.querySelector('audio')
    var playButton = document.querySelector('.jacket__play')
    var jacket = document.querySelector('.jacket')
    var visibleClass = 'is-visible'
    var playingClass = 'is-playing'
    var grabClass = 'is-grab'
    var grabbingClass = 'is-grabbing'
    var isGrabbing = false
    var prevX = 0
    var prevY = 0
    var translateX = 0
    var translateY = 0

    function render() {
      jacket.style.transform = 'translate(' + 0 + 'px, ' + translateY + 'px)'

      if (isGrabbing) {
        requestAnimationFrame(render)
      }
    }

    function mouseMoveHandler(e) {
      handleMove(e.clientX, e.clientY)
    }

    function mouseUpHandler(e) {
      handleEnd(e.clientX, e.clientY)
      body.removeEventListener('mousemove', mouseMoveHandler)
      body.removeEventListener('mouseup', mouseUpHandler)
    }

    function touchMoveHandler(e) {
      handleMove(e.changedTouches[0].clientX, e.changedTouches[0].clientY)
    }

    function touchEndHandler(e) {
      handleEnd(e.changedTouches[0].clientX, e.changedTouches[0].clientY)
      body.removeEventListener('touchmove', touchMoveHandler)
      body.removeEventListener('touchend', touchEndHandler)
    }

    function handleStart(x, y) {
      isGrabbing = true
      prevX = x
      prevY = y
      body.classList.add(grabbingClass)

      render()
    }

    function handleMove(x, y) {
      if (!isGrabbing) {
        return
      }

      translateX += x - prevX
      translateY += y - prevY
      prevX = x
      prevY = y
    }

    function handleEnd(x, y) {
      isGrabbing = false
      body.classList.remove(grabbingClass)
    }

    function clonePoem() {
      document.querySelectorAll('.poem__list').forEach(function(list) {
        list.querySelectorAll('.poem__item').forEach(function(item) {
          list.appendChild(item.cloneNode(true))
        })
      })
    }

    playButton.addEventListener('click', function() {
      if (body.classList.contains(playingClass)) {
        audio.pause()
        body.classList.remove(playingClass)
      } else {
        audio.play()
        body.classList.add(playingClass)
      }
    })

    playButton.addEventListener('mousedown', function(e) {
      e.stopPropagation()
    })

    jacket.addEventListener('mouseenter', function(e) {
      body.classList.add(grabClass)
    })

    jacket.addEventListener('mouseleave', function(e) {
      body.classList.remove(grabClass)
    })

    jacket.addEventListener('mousedown', function(e) {
      handleStart(e.clientX, e.clientY)
      body.addEventListener('mousemove', mouseMoveHandler)
      body.addEventListener('mouseup', mouseUpHandler)
    })

    jacket.addEventListener('touchstart', function(e) {
      handleStart(e.changedTouches[0].clientX, e.changedTouches[0].clientY)
      body.addEventListener('touchmove', touchMoveHandler)
      body.addEventListener('touchend', touchEndHandler)
    })

    jacket.addEventListener('contextmenu', function(e) {
      e.preventDefault()
    })

    clonePoem()

    setTimeout(function() {
      document.body.classList.add(visibleClass)
    }, 800)
  </script>
</body>
</html>
